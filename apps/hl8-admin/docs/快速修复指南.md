# 快速修复：网络连接错误

## 问题

前端显示：**"网络错误，无法连接到服务器 http://localhost:9528/v1"**

## 快速解决方案

### 方案 1: 重启前端开发服务器（最常见）

**原因**: 修改 `.env.local` 后，Vite 开发服务器需要重启才能加载新的环境变量。

**步骤**:

1. 停止当前前端开发服务器（按 `Ctrl+C`）
2. 重新启动：
   ```bash
   cd apps/hl8-admin
   pnpm run dev
   ```

### 方案 2: 检查环境变量是否正确加载

**在浏览器控制台检查**:

1. 打开浏览器开发者工具 (F12)
2. 在 Console 中运行：
   ```javascript
   console.log('API Base URL:', import.meta.env.VITE_API_BASE_URL)
   ```
3. **预期输出**: `http://localhost:9528/v1`
4. 如果不是，说明环境变量未加载，需要重启前端服务器

### 方案 3: 验证后端服务

**检查后端是否运行**:

```bash
# 检查后端进程
ps aux | grep "nest.*admin-api" | grep -v grep

# 测试后端连接
curl http://localhost:9528/v1/auth/getUserInfo
# 应该返回 401（需要认证），不是连接错误
```

**如果后端未运行**:

```bash
cd apps/admin-api
pnpm run dev
```

### 方案 4: 检查 CORS 配置

**检查后端 CORS 配置**:

```bash
cd apps/admin-api
cat .env | grep CORS_ORIGIN
```

**应该包含前端运行地址**，例如：

```env
CORS_ORIGIN=http://localhost:3000,http://localhost:5173,http://localhost:5174
```

**如果配置不正确**:

1. 编辑 `apps/admin-api/.env`
2. 更新 `CORS_ORIGIN`
3. 重启后端服务

## 验证修复

修复后，在浏览器中：

1. **打开开发者工具** (F12)
2. **查看 Network 标签**
3. **尝试登录**
4. **检查请求**:
   - URL 应该是 `http://localhost:9528/v1/auth/login`
   - 不应该有 CORS 错误
   - 不应该有连接错误

## 如果仍然无法连接

1. **检查浏览器控制台**的错误信息
2. **检查后端终端**的日志输出
3. **检查防火墙**是否阻止了连接
4. **尝试使用 `127.0.0.1` 代替 `localhost`**

---

**提示**: 大多数情况下，重启前端开发服务器就能解决问题！
