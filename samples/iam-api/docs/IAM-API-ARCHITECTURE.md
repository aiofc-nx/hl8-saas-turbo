# IAM-API æ¶æ„è®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

`iam-api` æ˜¯ä¸€ä¸ªåŸºäº **Clean Architectureï¼ˆæ¸…æ´æ¶æ„ï¼‰+ CQRSï¼ˆå‘½ä»¤æŸ¥è¯¢èŒè´£åˆ†ç¦»ï¼‰+ äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆEDAï¼‰+ äº‹ä»¶æº¯æºï¼ˆEvent Sourcing, ESï¼‰** çš„ NestJS åº”ç”¨ï¼Œç”¨äºæä¾›èº«ä»½è®¤è¯ä¸æˆæƒç®¡ç† (IAM) æœåŠ¡ã€‚

> ğŸ“– **ç›¸å…³æ–‡æ¡£**ï¼š
>
> - è¯¦ç»†çš„æ¶æ„åŸç†å’Œæœ¯è¯­å®šä¹‰è¯·å‚é˜… [æ¶æ„åŸç†ä¸æœ¯è¯­å®šä¹‰æ–‡æ¡£](../ARCHITECTURE.md)
> - äº‹ä»¶æº¯æºè¯¦ç»†è¯´æ˜è¯·å‚é˜… [äº‹ä»¶æº¯æºæ¶æ„æ‰©å±•æ–‡æ¡£](../EVENT-SOURCING.md)
> - å¦‚éœ€äº†è§£å½“å‰æ¶æ„ä¸å…¶ä»–æ¶æ„æ¨¡å¼çš„å¯¹æ¯”ï¼Œè¯·å‚é˜… [æ¶æ„å¯¹æ¯”æ–‡æ¡£](./ARCHITECTURE_COMPARISON.md)

## æ ¸å¿ƒæ¶æ„æ¨¡å¼

### 1. é¢†åŸŸé©±åŠ¨è®¾è®¡ (Domain-Driven Design, DDD)

é¡¹ç›®é‡‡ç”¨ DDD çš„ **æœ‰ç•Œä¸Šä¸‹æ–‡ (Bounded Context)** æ¨¡å¼ï¼Œå°†ä¸šåŠ¡é¢†åŸŸåˆ’åˆ†ä¸ºå¤šä¸ªç‹¬ç«‹çš„ä¸Šä¸‹æ–‡ï¼š

```
src/lib/bounded-contexts/
â”œâ”€â”€ iam/                    # èº«ä»½è®¤è¯ä¸æˆæƒä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ authentication/     # ç”¨æˆ·è®¤è¯
â”‚   â”œâ”€â”€ domain/             # åŸŸç®¡ç†
â”‚   â”œâ”€â”€ menu/               # èœå•ç®¡ç†
â”‚   â”œâ”€â”€ role/               # è§’è‰²ç®¡ç†
â”‚   â””â”€â”€ tokens/             # ä»¤ç‰Œç®¡ç†
â”œâ”€â”€ access-key/             # è®¿é—®å¯†é’¥ä¸Šä¸‹æ–‡
â”œâ”€â”€ api-endpoint/           # API ç«¯ç‚¹ä¸Šä¸‹æ–‡
â””â”€â”€ log-audit/              # å®¡è®¡æ—¥å¿—ä¸Šä¸‹æ–‡
    â”œâ”€â”€ login-log/          # ç™»å½•æ—¥å¿—
    â””â”€â”€ operation-log/      # æ“ä½œæ—¥å¿—
```

æ¯ä¸ªæœ‰ç•Œä¸Šä¸‹æ–‡éƒ½æ˜¯ç‹¬ç«‹çš„ä¸šåŠ¡é¢†åŸŸï¼Œæ‹¥æœ‰è‡ªå·±çš„ï¼š

- **é¢†åŸŸæ¨¡å‹** (Domain Models)
- **åº”ç”¨æœåŠ¡** (Application Services)
- **å‘½ä»¤/æŸ¥è¯¢** (Commands/Queries)
- **ç«¯å£æ¥å£** (Ports)

### 2. CQRS (Command Query Responsibility Segregation)

é¡¹ç›®ä¸¥æ ¼éµå¾ª CQRS æ¨¡å¼ï¼Œå°†**å†™æ“ä½œ**ï¼ˆå‘½ä»¤ï¼‰å’Œ**è¯»æ“ä½œ**ï¼ˆæŸ¥è¯¢ï¼‰å®Œå…¨åˆ†ç¦»ï¼š

#### å‘½ä»¤ (Commands) - å†™æ“ä½œ

- ä½ç½®ï¼š`src/lib/bounded-contexts/{context}/commands/`
- ç¤ºä¾‹ï¼š`UserCreateCommand`, `UserUpdateCommand`, `UserDeleteCommand`
- å¤„ç†ï¼šé€šè¿‡ `CommandHandler` å¤„ç†ï¼Œä¿®æ”¹é¢†åŸŸçŠ¶æ€

#### æŸ¥è¯¢ (Queries) - è¯»æ“ä½œ

- ä½ç½®ï¼š`src/lib/bounded-contexts/{context}/queries/`
- ç¤ºä¾‹ï¼š`PageUsersQuery`, `FindUserByIdQuery`
- å¤„ç†ï¼šé€šè¿‡ `QueryHandler` å¤„ç†ï¼Œåªè¯»å–æ•°æ®ï¼Œä¸ä¿®æ”¹çŠ¶æ€

#### å‘½ä»¤/æŸ¥è¯¢å¤„ç†å™¨

- ä½ç½®ï¼š`src/lib/bounded-contexts/{context}/application/command-handlers/` æˆ– `query-handlers/`
- èŒè´£ï¼šæ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡é€»è¾‘

### 3. Clean Architectureï¼ˆæ¸…æ´æ¶æ„ï¼‰

é¡¹ç›®é‡‡ç”¨ **Clean Architecture** çš„åˆ†å±‚æ¶æ„æ¨¡å¼ï¼Œé€šè¿‡**ç«¯å£å’Œé€‚é…å™¨æ¨¡å¼**å°†æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä¸å¤–éƒ¨ä¾èµ–è§£è€¦ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Infrastructure Layer (åŸºç¡€è®¾æ–½å±‚)     â”‚
â”‚  - Repository å®ç° (MikroORM)          â”‚
â”‚  - å¤–éƒ¨æœåŠ¡é€‚é…å™¨                        â”‚
â”‚  - HTTP æ§åˆ¶å™¨                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ ä¾èµ–æ³¨å…¥ï¼ˆå®ç°ç«¯å£æ¥å£ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Application Layer (åº”ç”¨å±‚)            â”‚
â”‚  - Use Case (ç”¨ä¾‹)                      â”‚
â”‚  - Command/Query Handlers              â”‚
â”‚  - Event Handlers                      â”‚
â”‚  - Application Services                â”‚
â”‚  - Ports (ç«¯å£æ¥å£)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ ä¾èµ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Domain Layer (é¢†åŸŸå±‚)                â”‚
â”‚  - èšåˆæ ¹ (Aggregate Root)              â”‚
â”‚  - å€¼å¯¹è±¡ (Value Object)                â”‚
â”‚  - é¢†åŸŸäº‹ä»¶ (Domain Event)              â”‚
â”‚  - é¢†åŸŸæœåŠ¡ (Domain Service)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¾èµ–æ–¹å‘**ï¼šå¤–å±‚ â†’ å†…å±‚ï¼ˆInfrastructure â†’ Application â†’ Domainï¼‰

**æ ¸å¿ƒåŸåˆ™**ï¼š

- **ä¾èµ–å€’ç½®**ï¼šåº”ç”¨å±‚å®šä¹‰ç«¯å£æ¥å£ï¼ŒåŸºç¡€è®¾æ–½å±‚å®ç°é€‚é…å™¨
- **é¢†åŸŸå±‚ç‹¬ç«‹**ï¼šé¢†åŸŸå±‚ä¸ä¾èµ–ä»»ä½•å¤–éƒ¨æ¡†æ¶å’ŒæŠ€æœ¯ç»†èŠ‚
- **ç«¯å£é€‚é…å™¨æ¨¡å¼**ï¼šé€šè¿‡ç«¯å£æ¥å£è§£è€¦ï¼Œå¯ä»¥è½»æ¾æ›¿æ¢å®ç°

### 4. äº‹ä»¶é©±åŠ¨æ¶æ„ (Event-Driven Architecture, EDA)

é¡¹ç›®é‡‡ç”¨**äº‹ä»¶é©±åŠ¨æ¶æ„**ï¼Œé€šè¿‡é¢†åŸŸäº‹ä»¶å®ç°æ¨¡å—é—´è§£è€¦å’Œå¼‚æ­¥å¤„ç†ï¼š

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š

- **é¢†åŸŸäº‹ä»¶**ï¼šè¡¨ç¤ºé¢†åŸŸå†…å‘ç”Ÿçš„ã€å¯¹ä¸šåŠ¡æœ‰é‡è¦æ„ä¹‰çš„äº‹æƒ…
- **äº‹ä»¶å‘å¸ƒ**ï¼šèšåˆæ ¹é€šè¿‡ `apply()` å’Œ `commit()` å‘å¸ƒäº‹ä»¶
- **äº‹ä»¶å¤„ç†**ï¼šäº‹ä»¶å¤„ç†å™¨å¼‚æ­¥å¤„ç†äº‹ä»¶ï¼Œå®ç°è·¨ä¸Šä¸‹æ–‡é€šä¿¡
- **æœ€ç»ˆä¸€è‡´æ€§**ï¼šé€šè¿‡å¼‚æ­¥äº‹ä»¶å¤„ç†ï¼Œç³»ç»Ÿæœ€ç»ˆè¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€

**ä¼˜åŠ¿**ï¼š

- **è§£è€¦**ï¼šå‘å¸ƒè€…å’Œè®¢é˜…è€…ä¸éœ€è¦çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨
- **å¯æ‰©å±•æ€§**ï¼šå¯ä»¥è½»æ¾æ·»åŠ æ–°çš„äº‹ä»¶å¤„ç†å™¨
- **å¼‚æ­¥å¤„ç†**ï¼šæå‡ç³»ç»Ÿå“åº”æ€§
- **æœ€ç»ˆä¸€è‡´æ€§**ï¼šé€šè¿‡äº‹ä»¶å®ç°ç³»ç»Ÿé—´çš„æœ€ç»ˆä¸€è‡´æ€§

è¯¦ç»†è¯´æ˜è¯·å‚é˜… [æ¶æ„åŸç†æ–‡æ¡£ - äº‹ä»¶é©±åŠ¨æ¶æ„](../ARCHITECTURE.md#4-äº‹ä»¶é©±åŠ¨æ¶æ„eda)

### 5. äº‹ä»¶æº¯æº (Event Sourcing, ES)

é¡¹ç›®é‡‡ç”¨**äº‹ä»¶æº¯æº**æ¶æ„æ¨¡å¼ï¼Œå­˜å‚¨æ‰€æœ‰é¢†åŸŸäº‹ä»¶ï¼Œé€šè¿‡é‡æ”¾äº‹ä»¶é‡å»ºçŠ¶æ€ï¼š

**æ ¸å¿ƒæ¦‚å¿µ**ï¼š

- **äº‹ä»¶å­˜å‚¨ï¼ˆEvent Storeï¼‰**ï¼šå­˜å‚¨æ‰€æœ‰é¢†åŸŸäº‹ä»¶
- **çŠ¶æ€é‡å»º**ï¼šé€šè¿‡é‡æ”¾äº‹ä»¶é‡å»ºèšåˆæ ¹çŠ¶æ€
- **å¿«ç…§ï¼ˆSnapshotï¼‰**ï¼šå®šæœŸåˆ›å»ºå¿«ç…§ï¼Œä¼˜åŒ–é‡å»ºæ€§èƒ½

**ä¼˜åŠ¿**ï¼š

- **å®Œæ•´çš„å†å²è®°å½•**ï¼šæ‰€æœ‰å˜æ›´éƒ½æœ‰è®°å½•
- **æ—¶é—´æ—…è¡Œ**ï¼šå¯ä»¥æŸ¥çœ‹ä»»ä½•å†å²æ—¶é—´ç‚¹çš„çŠ¶æ€
- **å®¡è®¡åŠŸèƒ½**ï¼šå®Œæ•´çš„å®¡è®¡æ—¥å¿—
- **ä¸ CQRS å®Œç¾ç»“åˆ**ï¼šå†™æ“ä½œåªè¿½åŠ äº‹ä»¶ï¼Œæ€§èƒ½å¥½

**å®æ–½æ–¹å¼**ï¼š

- æ¸è¿›å¼å®æ–½ï¼šå…ˆæ·»åŠ äº‹ä»¶å­˜å‚¨ï¼Œå†å®ç°çŠ¶æ€é‡å»ºï¼Œæœ€åå®Œå…¨åˆ‡æ¢
- ä¸ç°æœ‰æ¶æ„æ— ç¼ç»“åˆï¼šäº‹ä»¶æ—¢æ˜¯äº‹ä»¶é©±åŠ¨çš„äº‹ä»¶ï¼Œä¹Ÿæ˜¯äº‹ä»¶æº¯æºçš„äº‹ä»¶

è¯¦ç»†è¯´æ˜è¯·å‚é˜… [äº‹ä»¶æº¯æºæ¶æ„æ‰©å±•æ–‡æ¡£](../EVENT-SOURCING.md)

## é¡¹ç›®ç»“æ„

### ç›®å½•å±‚æ¬¡

```
apps/iam-api/src/
â”œâ”€â”€ api/                          # æ¥å£å±‚ (Presentation Layer)
â”‚   â”œâ”€â”€ iam/                      # IAM ç›¸å…³ REST API
â”‚   â”‚   â”œâ”€â”€ rest/                 # REST æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ dto/                  # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ access-key/                # è®¿é—®å¯†é’¥ API
â”‚   â”œâ”€â”€ endpoint/                  # API ç«¯ç‚¹ API
â”‚   â””â”€â”€ log-audit/                 # å®¡è®¡æ—¥å¿— API
â”‚
â”œâ”€â”€ lib/                           # ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)
â”‚   â”œâ”€â”€ bounded-contexts/          # æœ‰ç•Œä¸Šä¸‹æ–‡
â”‚   â”‚   â”œâ”€â”€ iam/                   # IAM ä¸Šä¸‹æ–‡
â”‚   â”‚   â”‚   â”œâ”€â”€ authentication/   # è®¤è¯å­ä¸Šä¸‹æ–‡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ application/   # åº”ç”¨å±‚
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ command-handlers/  # å‘½ä»¤å¤„ç†å™¨
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ query-handlers/    # æŸ¥è¯¢å¤„ç†å™¨
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ event-handlers/    # äº‹ä»¶å¤„ç†å™¨
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ service/           # åº”ç”¨æœåŠ¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ commands/              # å‘½ä»¤å®šä¹‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ queries/               # æŸ¥è¯¢å®šä¹‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ domain/                # é¢†åŸŸå±‚
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.ts            # ç”¨æˆ·èšåˆæ ¹
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ user.read.model.ts # ç”¨æˆ·è¯»æ¨¡å‹
â”‚   â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ password.value-object.ts # å¯†ç å€¼å¯¹è±¡
â”‚   â”‚   â”‚   â”‚   â”‚   â””â”€â”€ events/            # é¢†åŸŸäº‹ä»¶
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ ports/                 # ç«¯å£æ¥å£
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ user.read.repo-port.ts   # è¯»ä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ user.write.repo-port.ts  # å†™ä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/            # åŸŸç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ menu/              # èœå•ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ role/              # è§’è‰²ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ tokens/            # ä»¤ç‰Œç®¡ç†
â”‚   â”‚   â”œâ”€â”€ access-key/            # è®¿é—®å¯†é’¥ä¸Šä¸‹æ–‡
â”‚   â”‚   â”œâ”€â”€ api-endpoint/         # API ç«¯ç‚¹ä¸Šä¸‹æ–‡
â”‚   â”‚   â””â”€â”€ log-audit/            # å®¡è®¡æ—¥å¿—ä¸Šä¸‹æ–‡
â”‚   â””â”€â”€ shared/                    # å…±äº«èµ„æº
â”‚       â”œâ”€â”€ enums/                # æšä¸¾å®šä¹‰
â”‚       â””â”€â”€ constants/            # å¸¸é‡å®šä¹‰
â”‚
â”œâ”€â”€ infra/                         # åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)
â”‚   â””â”€â”€ bounded-contexts/          # åŸºç¡€è®¾æ–½å®ç°
â”‚       â”œâ”€â”€ iam/                   # IAM åŸºç¡€è®¾æ–½
â”‚       â”‚   â”œâ”€â”€ authentication/   # è®¤è¯åŸºç¡€è®¾æ–½
â”‚       â”‚   â”‚   â”œâ”€â”€ repository/   # ä»“å‚¨å®ç°
â”‚       â”‚   â”‚   â”‚   â”œâ”€â”€ user.read.pg.repository.ts   # è¯»ä»“å‚¨å®ç°
â”‚       â”‚   â”‚   â”‚   â””â”€â”€ user.write.pg.repository.ts  # å†™ä»“å‚¨å®ç°
â”‚       â”‚   â”‚   â””â”€â”€ iam.module.ts # æ¨¡å—é…ç½®
â”‚       â”‚   â”œâ”€â”€ domain/            # åŸŸåŸºç¡€è®¾æ–½
â”‚       â”‚   â”œâ”€â”€ menu/              # èœå•åŸºç¡€è®¾æ–½
â”‚       â”‚   â”œâ”€â”€ role/              # è§’è‰²åŸºç¡€è®¾æ–½
â”‚       â”‚   â””â”€â”€ tokens/            # ä»¤ç‰ŒåŸºç¡€è®¾æ–½
â”‚       â”œâ”€â”€ access-key/            # è®¿é—®å¯†é’¥åŸºç¡€è®¾æ–½
â”‚       â”œâ”€â”€ api-endpoint/          # API ç«¯ç‚¹åŸºç¡€è®¾æ–½
â”‚       â””â”€â”€ log-audit/             # å®¡è®¡æ—¥å¿—åŸºç¡€è®¾æ–½
â”‚
â”œâ”€â”€ app.module.ts                  # æ ¹æ¨¡å—
â”œâ”€â”€ main.ts                         # åº”ç”¨å…¥å£
â””â”€â”€ resources/                      # é™æ€èµ„æº
```

## æ¶æ„å±‚æ¬¡è¯¦è§£

### 1. æ¥å£å±‚ (API Layer) - `src/api/`

**èŒè´£**ï¼š

- æ¥æ”¶ HTTP è¯·æ±‚
- å‚æ•°éªŒè¯å’Œè½¬æ¢ (DTO)
- è°ƒç”¨ CQRS çš„ CommandBus/QueryBus
- è¿”å› HTTP å“åº”

**ç‰¹ç‚¹**ï¼š

- ä½¿ç”¨ NestJS çš„ `@Controller` è£…é¥°å™¨
- é€šè¿‡ `CommandBus` å’Œ `QueryBus` ä¸ä¸šåŠ¡å±‚äº¤äº’
- ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œåªè´Ÿè´£åè®®è½¬æ¢

**ç¤ºä¾‹**ï¼š

```typescript
@Controller('user')
export class UserController {
  constructor(
    private readonly queryBus: QueryBus,
    private readonly commandBus: CommandBus,
  ) {}

  @Post()
  async create(@Body() dto: UserCreateDto) {
    const command = new UserCreateCommand(dto);
    await this.commandBus.execute(command);
  }
}
```

### 2. ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer) - `src/lib/`

#### 2.1 åº”ç”¨å±‚ (Application Layer)

**ä½ç½®**ï¼š`src/lib/bounded-contexts/{context}/application/`

**èŒè´£**ï¼š

- **å®ç°ä¸šåŠ¡ç”¨ä¾‹ï¼ˆUse Caseï¼‰**ï¼šåº”ç”¨å±‚çš„æ ¸å¿ƒæ˜¯ Use Caseï¼Œæ¯ä¸ª Use Case ä»£è¡¨ä¸€ä¸ªå®Œæ•´çš„ä¸šåŠ¡æ“ä½œ
- ç¼–æ’é¢†åŸŸå¯¹è±¡å®Œæˆä¸šåŠ¡ç”¨ä¾‹
- å¤„ç†å‘½ä»¤å’ŒæŸ¥è¯¢ï¼ˆCQRSï¼‰
- å¤„ç†é¢†åŸŸäº‹ä»¶
- ä¸åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œåªè´Ÿè´£ç¼–æ’

**æ ¸å¿ƒæ¦‚å¿µï¼šUse Caseï¼ˆç”¨ä¾‹ï¼‰**

Use Case æ˜¯åº”ç”¨å±‚çš„æ ¸å¿ƒï¼Œä»£è¡¨ä¸€ä¸ªå®Œæ•´çš„ã€ç‹¬ç«‹çš„ä¸šåŠ¡æ“ä½œã€‚åœ¨ CQRS æ¨¡å¼ä¸‹ï¼ŒUse Case é€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼š

- **å‘½ä»¤å¤„ç†å™¨ï¼ˆCommand Handlerï¼‰** = **å†™æ“ä½œ Use Case**
- **æŸ¥è¯¢å¤„ç†å™¨ï¼ˆQuery Handlerï¼‰** = **è¯»æ“ä½œ Use Case**
- **åº”ç”¨æœåŠ¡ï¼ˆApplication Serviceï¼‰** = **å¤æ‚ä¸šåŠ¡æµç¨‹ Use Case**
- **äº‹ä»¶å¤„ç†å™¨ï¼ˆEvent Handlerï¼‰** = **äº‹ä»¶å¤„ç† Use Case**

**ç»„ä»¶**ï¼š

- **Command Handlers** (`command-handlers/`) - å†™æ“ä½œ Use Case
  - å¤„ç†å†™æ“ä½œå‘½ä»¤
  - ä¿®æ”¹é¢†åŸŸçŠ¶æ€
  - å‘å¸ƒé¢†åŸŸäº‹ä»¶
  - ç¤ºä¾‹ï¼š`UserCreateHandler.execute()` å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Use Caseï¼šåˆ›å»ºç”¨æˆ·

- **Query Handlers** (`query-handlers/`) - è¯»æ“ä½œ Use Case
  - å¤„ç†è¯»æ“ä½œæŸ¥è¯¢
  - ä»è¯»æ¨¡å‹è·å–æ•°æ®
  - ä¸ä¿®æ”¹çŠ¶æ€
  - ç¤ºä¾‹ï¼š`FindUserByIdQueryHandler.execute()` å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Use Caseï¼šæŸ¥è¯¢ç”¨æˆ·

- **Event Handlers** (`event-handlers/`) - äº‹ä»¶å¤„ç† Use Case
  - å¤„ç†é¢†åŸŸäº‹ä»¶
  - å®ç°è·¨ä¸Šä¸‹æ–‡é€šä¿¡
  - æ‰§è¡Œå‰¯ä½œç”¨ï¼ˆå¦‚å‘é€é‚®ä»¶ã€è®°å½•æ—¥å¿—ï¼‰
  - ç¤ºä¾‹ï¼š`UserCreatedHandler.handle()` å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Use Caseï¼šå¤„ç†ç”¨æˆ·åˆ›å»ºåçš„åç»­æ“ä½œ

- **Application Services** (`service/`) - å¤æ‚ä¸šåŠ¡æµç¨‹ Use Case
  - å¤æ‚çš„ä¸šåŠ¡ç”¨ä¾‹ç¼–æ’
  - è·¨èšåˆåè°ƒ
  - ç¤ºä¾‹ï¼š`AuthenticationService.execPasswordLogin()` å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Use Caseï¼šå¯†ç ç™»å½•

**ç«¯å£æ¥å£ï¼ˆPortsï¼‰**ï¼š

ç«¯å£æ¥å£å®šä¹‰åœ¨åº”ç”¨å±‚ï¼Œè¡¨ç¤º"éœ€è¦ä»€ä¹ˆåŠŸèƒ½"ï¼š

- **ä½ç½®**ï¼š`src/lib/bounded-contexts/{context}/ports/`
- **èŒè´£**ï¼šå®šä¹‰ä»“å‚¨æ¥å£ã€æœåŠ¡æ¥å£ç­‰å¤–éƒ¨ä¾èµ–å¥‘çº¦
- **ç¤ºä¾‹**ï¼š`UserReadRepoPort`ã€`UserWriteRepoPort`

è¯¦ç»†è¯´æ˜è¯·å‚é˜… [æ¶æ„åŸç†æ–‡æ¡£ - åº”ç”¨å±‚](../ARCHITECTURE.md#222-application-layeråº”ç”¨å±‚)

#### 2.2 é¢†åŸŸå±‚ (Domain Layer)

**ä½ç½®**ï¼š`src/lib/bounded-contexts/{context}/domain/`

**èŒè´£**ï¼š

- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- ä¸šåŠ¡è§„åˆ™å’Œçº¦æŸ
- é¢†åŸŸæ¨¡å‹å®šä¹‰

**ç»„ä»¶**ï¼š

- **èšåˆæ ¹ (Aggregate Root)**

  ```typescript
  export class User extends AggregateRoot {
    // é¢†åŸŸé€»è¾‘
    async loginUser(password: string) { ... }
    async verifyPassword(password: string) { ... }

    // å‘å¸ƒé¢†åŸŸäº‹ä»¶
    async created() {
      this.apply(new UserCreatedEvent(...));
    }
  }
  ```

- **å€¼å¯¹è±¡ (Value Objects)**

  ```typescript
  export class Password {
    // å°è£…å¯†ç ç›¸å…³é€»è¾‘
    static async hash(plain: string): Promise<Password> { ... }
    compare(plain: string): Promise<boolean> { ... }
  }
  ```

- **é¢†åŸŸäº‹ä»¶ (Domain Events)**

  ```typescript
  export class UserCreatedEvent {
    constructor(
      public readonly userId: string,
      public readonly username: string,
      public readonly domain: string,
    ) {}
  }
  ```

- **è¯»æ¨¡å‹ (Read Models)**
  - ç”¨äºæŸ¥è¯¢çš„åªè¯»æ•°æ®æ¨¡å‹
  - é€šå¸¸å¯¹åº”æ•°æ®åº“è§†å›¾æˆ–æŸ¥è¯¢ä¼˜åŒ–åçš„ç»“æ„

è¯¦ç»†è¯´æ˜è¯·å‚é˜… [æ¶æ„åŸç†æ–‡æ¡£ - é¢†åŸŸå±‚](../ARCHITECTURE.md#221-domain-layeré¢†åŸŸå±‚)

### 3. åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer) - `src/infra/`

**èŒè´£**ï¼š

- å®ç°ç«¯å£æ¥å£
- ä¸å¤–éƒ¨ç³»ç»Ÿäº¤äº’
- æŠ€æœ¯ç»†èŠ‚å®ç°

**ç»„ä»¶**ï¼š

- **ä»“å‚¨å®ç° (Repository Implementations)**

  ```typescript
  @Injectable()
  export class UserReadRepository implements UserReadRepoPort {
    constructor(private readonly em: EntityManager) {}

    async findUserById(id: string) {
      return await this.em.findOne('SysUser', { id });
    }
  }
  ```

- **æ¨¡å—é…ç½® (Module Configuration)**
  - ä¾èµ–æ³¨å…¥é…ç½®
  - ç«¯å£ä¸é€‚é…å™¨çš„ç»‘å®š
  - å¤–éƒ¨æœåŠ¡é›†æˆ

## æ•°æ®æµ

### å†™æ“ä½œæµç¨‹ (Command Flow)

```
1. HTTP Request
   â†“
2. Controller (Infrastructure Layer)
   - æ¥æ”¶ DTO
   - éªŒè¯å‚æ•°
   - åˆ›å»º Command
   â†“
3. CommandBus
   - è·¯ç”±åˆ°å¯¹åº”çš„ CommandHandler
   â†“
4. CommandHandler (Application Layer - Use Case)
   - ä» Repository åŠ è½½èšåˆï¼ˆå¦‚æœéœ€è¦ï¼‰
   - åˆ›å»ºæˆ–ä¿®æ”¹èšåˆæ ¹
   - è°ƒç”¨é¢†åŸŸæ–¹æ³•
   - ä¿å­˜èšåˆåˆ° Repository
   - å‘å¸ƒé¢†åŸŸäº‹ä»¶
   â†“
5. Repository (Infrastructure Layer)
   - ä½¿ç”¨ MikroORM æŒä¹…åŒ–
   â†“
6. Domain Event
   - èšåˆå‘å¸ƒäº‹ä»¶
   - äº‹ä»¶æäº¤åˆ°äº‹ä»¶æ€»çº¿
   â†“
7. EventHandler (Application Layer - Use Case)
   - å¼‚æ­¥å¤„ç†äº‹ä»¶
   - æ‰§è¡Œå‰¯ä½œç”¨ï¼ˆæ—¥å¿—ã€é€šçŸ¥ç­‰ï¼‰
```

**ç¤ºä¾‹ï¼šç”¨æˆ·åˆ›å»ºå®Œæ•´æµç¨‹**

```typescript
// 1. Controller æ¥æ”¶è¯·æ±‚
@Controller('users')
export class UserController {
  @Post()
  async createUser(@Body() dto: CreateUserDTO) {
    const command = new UserCreateCommand(...);
    await this.commandBus.execute(command);
  }
}

// 2. CommandHandler æ‰§è¡Œ Use Case
@CommandHandler(UserCreateCommand)
export class UserCreateHandler {
  async execute(command: UserCreateCommand) {
    // Use Case: åˆ›å»ºç”¨æˆ·
    // 1. éªŒè¯ç”¨æˆ·åå”¯ä¸€æ€§
    // 2. åˆ›å»ºç”¨æˆ·èšåˆæ ¹
    // 3. ä¿å­˜åˆ°æ•°æ®åº“
    // 4. å‘å¸ƒç”¨æˆ·åˆ›å»ºäº‹ä»¶
  }
}

// 3. èšåˆæ ¹å‘å¸ƒäº‹ä»¶
export class User extends AggregateRoot {
  async created() {
    this.apply(new UserCreatedEvent(...));
  }
}

// 4. EventHandler å¤„ç†äº‹ä»¶
@EventsHandler(UserCreatedEvent)
export class UserCreatedHandler {
  async handle(event: UserCreatedEvent) {
    // Use Case: å¤„ç†ç”¨æˆ·åˆ›å»ºåçš„åç»­æ“ä½œ
    // åˆå§‹åŒ–æƒé™ã€å‘é€é€šçŸ¥ç­‰
  }
}
```

### è¯»æ“ä½œæµç¨‹ (Query Flow)

```
1. HTTP Request
   â†“
2. Controller (Infrastructure Layer)
   - æ¥æ”¶æŸ¥è¯¢å‚æ•°
   - åˆ›å»º Query
   â†“
3. QueryBus
   - è·¯ç”±åˆ°å¯¹åº”çš„ QueryHandler
   â†“
4. QueryHandler (Application Layer - Use Case)
   - è°ƒç”¨ ReadRepository
   â†“
5. ReadRepository (Infrastructure Layer)
   - ä½¿ç”¨ MikroORM æŸ¥è¯¢
   - è¿”å›è¯»æ¨¡å‹
   â†“
6. Response
   - è¿”å›æŸ¥è¯¢ç»“æœ
```

**ç¤ºä¾‹ï¼šæŸ¥è¯¢ç”¨æˆ·**

```typescript
// 1. Controller æ¥æ”¶æŸ¥è¯¢è¯·æ±‚
@Controller('users')
export class UserController {
  @Get(':id')
  async getUser(@Param('id') id: string) {
    const query = new FindUserByIdQuery(id);
    return await this.queryBus.execute(query);
  }
}

// 2. QueryHandler æ‰§è¡Œ Use Case
@QueryHandler(FindUserByIdQuery)
export class FindUserByIdQueryHandler {
  async execute(query: FindUserByIdQuery) {
    // Use Case: æŸ¥è¯¢ç”¨æˆ·
    return this.repository.getUserById(query.id);
  }
}
```

è¯¦ç»†è¯´æ˜è¯·å‚é˜… [æ¶æ„åŸç†æ–‡æ¡£ - æ•°æ®æµ](../ARCHITECTURE.md#5-æ•°æ®æµ)

## ä¾èµ–å…³ç³»

### ä¾èµ–æ–¹å‘

```
Infrastructure Layer (åŸºç¡€è®¾æ–½å±‚)
   â†“ (ä¾èµ–)
Application Layer (åº”ç”¨å±‚ï¼ŒåŒ…å« Ports)
   â†“ (ä¾èµ–)
Domain Layer (é¢†åŸŸå±‚)
```

**åŸåˆ™**ï¼š

- **ä¾èµ–å€’ç½®**ï¼šåº”ç”¨å±‚å®šä¹‰ç«¯å£æ¥å£ï¼ˆPortsï¼‰ï¼ŒåŸºç¡€è®¾æ–½å±‚å®ç°é€‚é…å™¨ï¼ˆAdaptersï¼‰
- **å•å‘ä¾èµ–**ï¼šå¤–å±‚ä¾èµ–å†…å±‚ï¼Œå†…å±‚ä¸ä¾èµ–å¤–å±‚
- **æ¥å£éš”ç¦»**ï¼šé€šè¿‡ç«¯å£æ¥å£è§£è€¦ï¼Œå¯ä»¥è½»æ¾æ›¿æ¢å®ç°
- **é¢†åŸŸå±‚ç‹¬ç«‹**ï¼šé¢†åŸŸå±‚ä¸ä¾èµ–ä»»ä½•å¤–éƒ¨æ¡†æ¶å’ŒæŠ€æœ¯ç»†èŠ‚

### æ¨¡å—ä¾èµ–

```
AppModule
   â†“
ApiModule
   â†“
InfraModule (å„ä¸ªä¸Šä¸‹æ–‡çš„åŸºç¡€è®¾æ–½æ¨¡å—)
   â†“
ApplicationModule (å„ä¸ªä¸Šä¸‹æ–‡çš„åº”ç”¨æ¨¡å—)
   â†“
Domain (é¢†åŸŸæ¨¡å‹ï¼Œæ— ä¾èµ–)
```

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶

- **NestJS**: åº”ç”¨æ¡†æ¶
- **Fastify**: HTTP æœåŠ¡å™¨
- **MikroORM**: ORM æ¡†æ¶ï¼ˆæ›¿ä»£ Prismaï¼‰
- **TypeScript**: å¼€å‘è¯­è¨€

### CQRS æ”¯æŒ

- **@nestjs/cqrs**: CQRS æ¨¡å¼å®ç°
- **CommandBus/QueryBus**: å‘½ä»¤å’ŒæŸ¥è¯¢æ€»çº¿

### è®¤è¯æˆæƒ

- **JWT**: èº«ä»½è®¤è¯
- **Casbin**: åŸºäº RBAC çš„æˆæƒ
- **@hl8/casbin**: Casbin é›†æˆæ¨¡å—

### å…¶ä»–

- **Redis**: ç¼“å­˜å’Œé™æµ
- **Swagger**: API æ–‡æ¡£
- **Class Validator**: å‚æ•°éªŒè¯

## è®¾è®¡åŸåˆ™

### 1. å•ä¸€èŒè´£åŸåˆ™ (SRP)

- æ¯ä¸ªç±»/æ¨¡å—åªè´Ÿè´£ä¸€ä¸ªèŒè´£
- CommandHandler åªå¤„ç†å‘½ä»¤
- QueryHandler åªå¤„ç†æŸ¥è¯¢

### 2. å¼€é—­åŸåˆ™ (OCP)

- é€šè¿‡ç«¯å£æ¥å£æ‰©å±•åŠŸèƒ½
- æ–°å¢ä»“å‚¨å®ç°æ— éœ€ä¿®æ”¹ä¸šåŠ¡é€»è¾‘

### 3. ä¾èµ–å€’ç½®åŸåˆ™ (DIP)

- ä¸šåŠ¡å±‚ä¾èµ–æŠ½è±¡ï¼ˆç«¯å£ï¼‰
- åŸºç¡€è®¾æ–½å±‚å®ç°å…·ä½“ç»†èŠ‚

### 4. æ¥å£éš”ç¦»åŸåˆ™ (ISP)

- è¯»ä»“å‚¨å’Œå†™ä»“å‚¨åˆ†ç¦»
- ä¸åŒæŸ¥è¯¢åœºæ™¯ä½¿ç”¨ä¸åŒæ¥å£

### 5. é¢†åŸŸé©±åŠ¨è®¾è®¡åŸåˆ™

- èšåˆæ ¹ä¿æŠ¤ä¸šåŠ¡ä¸å˜é‡
- é¢†åŸŸäº‹ä»¶å®ç°è·¨ä¸Šä¸‹æ–‡é€šä¿¡
- æœ‰ç•Œä¸Šä¸‹æ–‡éš”ç¦»ä¸åŒä¸šåŠ¡é¢†åŸŸ

## æœ€ä½³å®è·µ

### 1. å‘½ä»¤è®¾è®¡

- å‘½ä»¤åº”è¯¥æ˜¯ä¸å¯å˜çš„
- å‘½ä»¤åŒ…å«æ‰§è¡Œæ“ä½œæ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯
- å‘½ä»¤åç§°ä½¿ç”¨åŠ¨è¯ï¼š`CreateUser`, `UpdateUser`, `DeleteUser`

### 2. æŸ¥è¯¢è®¾è®¡

- æŸ¥è¯¢ä¸ä¿®æ”¹çŠ¶æ€
- æŸ¥è¯¢å¯ä»¥è¿”å›è¯»æ¨¡å‹æˆ– DTO
- å¤æ‚æŸ¥è¯¢ä½¿ç”¨ä¸“é—¨çš„ QueryHandler

### 3. é¢†åŸŸäº‹ä»¶

- äº‹ä»¶åç§°ä½¿ç”¨è¿‡å»æ—¶ï¼š`UserCreated`, `UserDeleted`
- äº‹ä»¶åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯ä¾›å¤„ç†å™¨ä½¿ç”¨
- äº‹ä»¶å¤„ç†å™¨åº”è¯¥æ˜¯å¹‚ç­‰çš„

### 4. ä»“å‚¨è®¾è®¡

- è¯»ä»“å‚¨å’Œå†™ä»“å‚¨åˆ†ç¦»ï¼ˆCQRSï¼‰
- è¯»ä»“å‚¨è¿”å›è¯»æ¨¡å‹
- å†™ä»“å‚¨æ“ä½œèšåˆæ ¹

### 5. æ¨¡å—ç»„ç»‡

- æ¯ä¸ªæœ‰ç•Œä¸Šä¸‹æ–‡æœ‰ç‹¬ç«‹çš„æ¨¡å—
- åŸºç¡€è®¾æ–½æ¨¡å—è´Ÿè´£ä¾èµ–æ³¨å…¥é…ç½®
- åº”ç”¨æ¨¡å—åŒ…å«ä¸šåŠ¡é€»è¾‘

## æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„æœ‰ç•Œä¸Šä¸‹æ–‡

1. **åˆ›å»ºé¢†åŸŸæ¨¡å‹** (`src/lib/bounded-contexts/{new-context}/domain/`)
2. **å®šä¹‰ç«¯å£æ¥å£** (`src/lib/bounded-contexts/{new-context}/ports/`)
3. **å®ç°åº”ç”¨æœåŠ¡** (`src/lib/bounded-contexts/{new-context}/application/`)
4. **å®ç°åŸºç¡€è®¾æ–½** (`src/infra/bounded-contexts/{new-context}/`)
5. **åˆ›å»º REST API** (`src/api/{new-context}/`)
6. **æ³¨å†Œæ¨¡å—** (`src/api/api.module.ts`)

### æ·»åŠ æ–°çš„å‘½ä»¤/æŸ¥è¯¢

1. **å®šä¹‰å‘½ä»¤/æŸ¥è¯¢** (`commands/` æˆ– `queries/`)
2. **åˆ›å»ºå¤„ç†å™¨** (`application/command-handlers/` æˆ– `query-handlers/`)
3. **åœ¨ Controller ä¸­ä½¿ç”¨** (`api/{context}/rest/`)

## å…³é”®æœ¯è¯­å®šä¹‰

è¯¦ç»†çš„æœ¯è¯­å®šä¹‰è¯·å‚é˜… [æ¶æ„åŸç†ä¸æœ¯è¯­å®šä¹‰æ–‡æ¡£](../ARCHITECTURE.md#6-å…³é”®æœ¯è¯­å®šä¹‰)ï¼ŒåŒ…æ‹¬ï¼š

- **Clean Architecture æœ¯è¯­**ï¼šèšåˆæ ¹ã€å®ä½“ã€å€¼å¯¹è±¡ã€é¢†åŸŸæœåŠ¡ã€ç«¯å£ã€é€‚é…å™¨ç­‰
- **CQRS æœ¯è¯­**ï¼šå‘½ä»¤ã€æŸ¥è¯¢ã€å‘½ä»¤å¤„ç†å™¨ã€æŸ¥è¯¢å¤„ç†å™¨ã€è¯»å–æ¨¡å‹ã€å†™å…¥æ¨¡å‹ç­‰
- **äº‹ä»¶é©±åŠ¨æ¶æ„æœ¯è¯­**ï¼šé¢†åŸŸäº‹ä»¶ã€äº‹ä»¶å‘å¸ƒã€äº‹ä»¶è®¢é˜…ã€äº‹ä»¶å¤„ç†å™¨ã€äº‹ä»¶æ€»çº¿ã€æœ€ç»ˆä¸€è‡´æ€§ç­‰
- **é€šç”¨æœ¯è¯­**ï¼šç”¨ä¾‹ï¼ˆUse Caseï¼‰ã€æœ‰ç•Œä¸Šä¸‹æ–‡ã€ä»“å‚¨ã€åº”ç”¨æœåŠ¡ã€å·¥å‚æ–¹æ³•ã€ä¾èµ–æ³¨å…¥ç­‰
- **é¢å‘å¯¹è±¡ç¼–ç¨‹æœ¯è¯­**ï¼šé¢†åŸŸæ–¹æ³•ã€å®ä¾‹æ–¹æ³•ã€é™æ€æ–¹æ³•ã€å·¥å‚æ–¹æ³•ã€æ„é€ å‡½æ•°ã€è®¿é—®ä¿®é¥°ç¬¦ã€æ¥å£ã€ç»§æ‰¿ã€å®ç°ç­‰

## æ€»ç»“

`iam-api` é‡‡ç”¨äº†ç°ä»£åŒ–çš„ä¼ä¸šçº§æ¶æ„æ¨¡å¼ï¼Œé€šè¿‡ **Clean Architecture + CQRS + äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆEDAï¼‰** å®ç°äº†ï¼š

- âœ… **æ¸…æ™°çš„èŒè´£åˆ†ç¦»**ï¼šåŸºç¡€è®¾æ–½å±‚ã€åº”ç”¨å±‚ã€é¢†åŸŸå±‚å„å¸å…¶èŒ
- âœ… **Use Case é©±åŠ¨**ï¼šåº”ç”¨å±‚ä»¥ Use Case ä¸ºæ ¸å¿ƒï¼Œæ¯ä¸ª Handler æˆ– Service æ–¹æ³•å°±æ˜¯ä¸€ä¸ª Use Case
- âœ… **é«˜å¯æµ‹è¯•æ€§**ï¼šé€šè¿‡ç«¯å£æ¥å£ï¼Œå¯ä»¥è½»æ¾æ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ–
- âœ… **é«˜å¯æ‰©å±•æ€§**ï¼šæ–°å¢åŠŸèƒ½ä¸å½±å“ç°æœ‰ä»£ç 
- âœ… **ä¸šåŠ¡é€»è¾‘é›†ä¸­**ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘é›†ä¸­åœ¨é¢†åŸŸå±‚ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤
- âœ… **æŠ€æœ¯æ— å…³æ€§**ï¼šé¢†åŸŸå±‚ä¸ä¾èµ–å…·ä½“æŠ€æœ¯å®ç°
- âœ… **äº‹ä»¶é©±åŠ¨**ï¼šé€šè¿‡é¢†åŸŸäº‹ä»¶å®ç°æ¨¡å—é—´è§£è€¦å’Œå¼‚æ­¥å¤„ç†
- âœ… **è¯»å†™åˆ†ç¦»**ï¼šé€šè¿‡ CQRS å®ç°è¯»å†™æ“ä½œçš„ä¼˜åŒ–å’Œç‹¬ç«‹æ‰©å±•

è¿™ç§æ¶æ„ç‰¹åˆ«é€‚åˆï¼š

- å¤æ‚çš„ä¸šåŠ¡é¢†åŸŸ
- éœ€è¦é•¿æœŸç»´æŠ¤çš„ç³»ç»Ÿ
- å›¢é˜Ÿåä½œå¼€å‘
- éœ€è¦é«˜å¯æµ‹è¯•æ€§çš„é¡¹ç›®
- éœ€è¦é«˜å¯æ‰©å±•æ€§çš„ç³»ç»Ÿ
- éœ€è¦äº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥å¤„ç†åœºæ™¯
